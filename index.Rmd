--- 
# title: 'Geography with R: a Practical Introduction'
title: 'Simple Features for Geographic data: an Introduction'
author:
- Robin Lovelace
- Jakub Nowosad
date: '`r Sys.Date()`'
output: pdf_document
# documentclass: book
github-repo: Robinlovelace/rgeobook
link-citations: yes
bibliography:
- refs.bib
- packages.bib
site: bookdown::bookdown_site
biblio-style: apalike
url: https\://Robinlovelace.github.io/rgeobook/
---

---
knit: "bookdown::preview_chapter"
---

## Prerequisites {-}

To run the following code you must have **sf** installed, e.g. via:

```{r, eval=FALSE}
install.packages("sf") # for the stable version
```

or 

```{r, eval=FALSE}
devtools::install_github("edzer/sfr") # for the development version
```

You need a recent version of the GDAL and GEOS libraries installed for this to work on Mac and Linux. See the package's [README](https://github.com/edzer/sfr) for information on that.

# Introduction {#intro}

<!-- Uncomment when it becomes a book -->
<!-- This book exists at the intersection between two vast subjects, Geography and R (Figure \@ref(fig:venn)). -->
<!-- It would make little sense to attempt a comprehensive coverage of either within a this book: this is a practical book. -->
<!-- This means that we will learn to *do* Geography, not talk about Geography, with R. -->

<!-- ## Why Geography with R? -->

<!-- Of Geography and R, the former is certainly the larger. -->
<!-- Geography as an academic discipline has over 2,000 years of history, notwithstanding the largely undocumented map-making skills of our prehistoric ancestors. -->

<!-- In this book we treat R as a 'tool for the trade', in a similar way that early geographers used rulers, compasses, sextants and other instruments to advance knowledge about the world. -->

<!-- Ideas: something on geocomputation, other GIS software, and the difference between 'R for geographic data' and 'R for geography'. -->

<!-- Actions often speak louder than words, so this is a deliberately practical tutorial. -->
<!-- But before we crack-on with the action, however, a few introductory remarks are needed to explain the approach taken here and provide context. -->

<!-- This tutorial exists at the interface between two vast topics, Geography and R (Figure \@ref(fig:venn)). -->
<!-- Expertise in both areas would take years of study, and is certainly not a pre-requisite for handling geographic data with R, and creating some beautiful and useful maps. -->
<!-- However, background an understanding of both topics will help you get the most out of the subsequent work, so we start with some definitions and references for further reading for historical context: -->

<!-- - Geography is the study of where things are located on the Earth. Primarily we are interested in the part of Geography that deals with *geographic data* and *maps*: information with a location and the visualisation of such data. -->

<!-- - R is an open source statistical programming language that has powerful geographical capabilities, thanks largely to add-on packages. -->



<!-- ```{r venn, fig.cap="Venn diagram of the intersection between Geography and R.", echo=FALSE, out.height="1cm"} -->
<!-- source("code/01-venn.R") -->
<!-- ``` -->

## An introduction to Simple Features

Simple Features is a data model developed and endorsed by the Open Geospatial Consortium ([OGC](http://portal.opengeospatial.org/files/?artifact_id=25355)). It is a hierarchical data model that simplifies geographic data by condensing the complex range of possible geographic forms (e.g., line, point, polygon, multipolygon forms) into a single 'meta-class' called Geometry (Figure \@ref(fig:sf-ogc)).

```{r sf-ogc, fig.cap="The Simple Features class hierarchy, used with permission (on condition of linking to the source) from the Open Geospatial Consortium's document 06-103r4 (see http://www.opengeospatial.org/standards/sfa)", out.width="100%", echo=FALSE}
knitr::include_graphics("figures/simple-feature-class-hierarchy.png")
```

The R implementation of Simple Features is provided by the **sf** package [@R-sf].
**sf** incorporates the functionality of the 3 main packages of the **sp** paradigm (**sp** for the class system, **rgdal** for reading and writing data, **rgeos** for spatial operations undertaken by GEOS) in a single, cohesive whole.
This is well-documented in **sf**'s [vignettes](http://cran.rstudio.com/package=sf):

```{r, eval=FALSE}
vignette("sf1") # for an introduction to the package
vignette("sf2") # for reading, writing and converting Simple Features
vignette("sf3") # for manipulating simple features
```

There are many advantages of **sf** over **sp**, including:

- Faster reading and writing of data (more than 10 times faster in some cases)
- **sf** objects can be treated as dataframes in most operations
- **sf** function names are relatively consistent and intuitive compared with the function names and syntax of the **sp**, **rgdal** and **rgeos** packages that it supercedes.

However **sf** should be used with caution. A major disadvantage is that it is not yet *feature complete* and unsupported by many spatial data analysis packages which still depend on **sp** classes and will likely to so for many years to come.

Fortunately it is easy to translate between **sf** and **sf** classes using the following functions:

<!-- 
- r, rstudio, gdal, proj4, geos, udunits 
- r packages sf, raster, etc.
- datasets 
-->

<!-- ## Introduction to GIS -->

<!-- 
- what's R
- what's GIS
- GIS data models (vector vs raster)
- coordinate reference system - CRS
- GIS data formats
- GDAL, GEOS, PROJ4
- GIS R package
- GIS beyond R 
-->